%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%2345678901234567890123456789012345678901234567890123456789012345678901234567890
%        1         2         3         4         5         6         7         8

\documentclass[letterpaper, 12 pt, conference]{ieeeconf}  % Comment this line out
                                                          % if you need a4paper
%\documentclass[a4paper, 10pt, conference]{ieeeconf}      % Use this line for a4
                                                          % paper

\IEEEoverridecommandlockouts                              % This command is only
                                                          % needed if you want to
                                                          % use the \thanks command
\overrideIEEEmargins
% See the \addtolength command later in the file to balance the column lengths
% on the last page of the document



% The following packages can be found on http:\\www.ctan.org
\usepackage{graphicx} % for pdf, bitmapped graphics files
\usepackage{bm}
\newcommand{\uvec}[1]{\boldsymbol{\hat{\textbf{#1}}}}
%\usepackage{epsfig} % for postscript graphics files
%\usepackage{mathptmx} % assumes new font selection scheme installed
%\usepackage{times} % assumes new font selection scheme installed
%\usepackage{amsmath} % assumes amsmath package installed
%\usepackage{amssymb}  % assumes amsmath package installed

\title{\LARGE \bf
Deterministic Rabin Cryptosystem
}

%\author{ \parbox{3 in}{\centering Huibert Kwakernaak*
%         \thanks{*Use the $\backslash$thanks command to put information here}\\
%         Faculty of Electrical Engineering, Mathematics and Computer Science\\
%         University of Twente\\
%         7500 AE Enschede, The Netherlands\\
%         {\tt\small h.kwakernaak@autsubmit.com}}
%         \hspace*{ 0.5 in}
%         \parbox{3 in}{ \centering Pradeep Misra**
%         \thanks{**The footnote marks may be inserted manually}\\
%        Department of Electrical Engineering \\
%         Wright State University\\
%         Dayton, OH 45435, USA\\
%         {\tt\small pmisra@cs.wright.edu}}
%}

\author{Vishnu Priy Agnihotri$^{1}$ % <-this % stops a space
\thanks{}% <-this % stops a space
\thanks{$^{1}$Vishnu Priy Agnihotri, BT18CSE018, Department of Computer Science and Engineering,NIT Uttarakhand}%
\thanks{}%
}


\begin{document}



\maketitle
\thispagestyle{empty}
\pagestyle{empty}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{abstract}

In this paper, Tiny Encryption Algorithm is discussed and modification for it is proposed in order to strengthen the security. This modified algorithm has the same sixty-four(64) Feistel rounds as the original one but has a randomized key schedule to improve security. It's low memory footprint and minimalistic implementation enables it to be implemented on resource constrained devices such as IoT devices , RFID tags etc. This paper focuses on the modified TEA algorithm with respect to IOT devices.
 Keywords-TEA, IoT, lightweight encryption, block cipher, cryptography, feistel cipher



\end{abstract}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{INTRODUCTION}

Encryption is a way of altering data so that only authorized parties can understand it. The goal is to avoid revealing the information to any third party.Although encrypted data appears random, encryption proceeds in a logical, predictable way, so that a party receiving the encrypted data and in possession of the key used to encrypt the data can decrypt the data, turning it back into plaintext. Truly secure encryption will be complex enough that a third party is highly unlikely to decrypt the ciphertext by brute force – in other words, by guessing.

The Internet of Things (IoT) describes the network of physical objects—“things”—that are embedded with sensors, software, and other technologies for the purpose of connecting and exchanging data with other devices and systems over the internet.Now-a-days it has become a major part of the various netwroks fields all over the world. Like, vehicles, home automation,
some wearable technologies, media and security systems everywhere IoT finds its use. This massive connectivity of devices and enormous data on the air have made information susceptible to diﬀerent type of attacks. Cryptographic algorithms are used to provide conﬁdentiality and maintain the integrity of the information. But small size, limited computational capability, limited memory, and power resources of the devices make it diﬃcult to use the resource intensive traditional cryptographic algorithms for information security. In this scenario it becomes impertinent to develop lightweight security schemes for IoT.


\section{Existing Work}
The section below describes in detail the basic TEA algorithm.Wheeler et al. (1994) at the computer laboratory of Cambridge University developed the TEA encode routine.It is a Fiestel type cipher.Input consists of plaintext block and a passkey K. Plaintext is represented by P in which it can be divided into two halves, Left[0] and Right[0] while the cipher text is represented by C (Left[64], Right[64]). Each half of the plaintext, P is being used to encrypt the other half over 64 rounds of processing and is then combined together in order to produce the cipher text block .The specification for TEA states a 128-bit key is to be divided into four 32-bit key words and the block size of each encryption is 64-bits, of which is to be divided into two 32-bit words [4]. TEA utilizes a Feistel scheme, noted as F, for its encryption rounds in which one round of TEA includes two Feistel operations and a number of additions and bitwise XOR operations [3]


\subsection{Encryption in TEA}
At first, the 64-bits plaintext is split into two inputs with 32-bits each (which are y and z). There are four passkeys that can be defined as the passcode for the user. These passkeys are also assigned as inputs in the TEA architecture. 

The initial z input value is firstly being left-shifted with 4-bits and the result is then being added up with the first passkey which is the K[0] and the result is then being kept aside in the memory named as z-2. The initial z input value is again being used to be added up with a constant called delta which is 2654435769 in decimal value and the result is being stored in the memory named as z-3. This delta  is derived from the golden number ratio to ensure that the sub keys are distinct and its precise value has no cryptographic significance.   The following steps is to reuse again the initial z input value to undergo a right-shift of 5-bits and the result is then being saved in the memory named z-5. The keys K[0] and K[1] are used in the odd rounds and the keys K[2] and K[3] are used in even rounds. 

 XOR operation is then being used for all the three values in z-2, z-3 and also z-5. This carry the meaning of z-2 being XORed with z-3 and the result is being XORed again with z-5. This final result is then recorded in the memory named z-6. Furthermore, the value of z-6 must be added up with the initial y input value and the result is hence stored in the memory x-1. One TEA round (half a cycle) is considered as completed up to this point. 

The encryption process is then being proceed to the next round by left-shifting the value of x-1 with 4-bits and the result is added up with the third passkey which is K[2]. The result is then being kept in a memory named y-2. The process is continued with the x-1 value being added up with the Golden Ratio constant and y-3 memory is used to record the result obtained. Followed by the value of x-1 is again being reused to undergo a right-shift of 5-bits then the result is added with the value of the fourth passkey which is K[3].
  
  The final result is then being saved in the memory y-5. XOR operation is again being used for all the three values in y-2, y-3 and also y-5. This carry the meaning of y-2 being XORed with y-3 and the result is being XORed again with y-5. This final result is then recorded in the memory named y-6.
Moreover, the value of y-6 must be added up with the initial z input value and the result is hence stored in the memory x-2. The output (encrypted text) is then indicated as final-y and final-z. The second TEA round (another half of the TEA cycle) is considered completed. A complete cycle of TEA encryption is now repeated for thirty two times to reach the requirement of a full TEA encryption. 

\includegraphics[scale=0.9]{1}

FIG 1:TEA Encryption process
\subsection{Decryption in TEA}
 The decryption of TEA is basically almost the same as the encryption of TEA with the function is being reversed. The decryption process started with the encrypted text is now treated as the input of the algorithm in which the final-y is indicated as input-y and final-z is indicated as the input-z. The input-z is initially being left-shifted with 4-bits and the result is then being added up with the third passkey which is K[2] and the result is then being kept aside in the memory with the name of z-2. The input-z is then being utilized to add up with the Golden Ratio constant and the result is being saved in the memory z-3. The following step is to reuse again the input-z value to undergo a right-shift of 5-bits and the result is being added up with the fourth passkey which is the K[3] with the result being recorded in the memory named z-5.

 The decryption process continued with the z-2 being XORed with the z-3 and the result is again being XORed with z-5. This final result is then stored in the memory carrying the name of z-6.
 Next, the value of z-6 must be reduced by the input-y value and the result is being saved in the memory x-1 in order for the one round TEA decryption to be utilized up to this point.The decryption process is then being proceed to the next round by left-shifting the value of x-1 with 4-bits and the result is added up with the first passkey carrying the name of K[0]. Then the output is being kept in y-2 memory. The algorithm is progressed with the x-1 value being added with the Golden Ratio constant and a y-3 memory is utilized to record the result obtained. Followed by the x-1 value is being reused to undergo a right-shift of 5-bits with the output is being added up with the value of the second passkey which is K[1]. The final result is then being stored in the y-5 memory.
 The decryption process is progressed with the y-2 being XORed with the y-3 and the result is again being XORed with y-5. This final result is then recorded in the memory with the name of y-6.
 Moreover, the value of y-6 must be reduced by the input-z and the result is being saved in the memory x-2. A complete cycle of TEA is now repeated for thirty two times to reach the requirement of a full TEA decryption. The output (decrypted text) is then being compared with the input (plaintext) of the encryption process in order to obtain a same value or message. 

\includegraphics[scale=0.6]{2}

FIG 2: TEA Decryption process



\subsection{Proposed Modification}
The proposed modification involves minimising the risk of attackers analysing the key schedule and thus exploiting the different situations that might arise from it. Main idea is to change the key schedule every round.In the original algorithm we observe that when z is left shifted 4 bits (FIG 1), it is then added to K[0] . z is right shifted 5 bits and then is added to K[1] . y is left shifted 4 bits and then is added to K[2] and is right shifted 5 bits and added to K[3]. These same additions are carried out for 32 rounds. We propose to modify these in such a way that they are not the same for every round.



After performing the shift operation we have to decide which 32 bit key part to add , whether K[0],K[1],K[2] or K[3] by the following procedure. Let i denote the round number (0 to 31).



1:For adding to z left shifted by 4 bits we choose the key given by adding 0 to round number and then taking modulo 32.


2:For adding to z right shifted by 5 bits we choose the key given by adding 1 to round number and then taking modulo 32.


3:For adding to y left shifted by 4 bits we choose the key given by adding 2 to round number and then taking modulo 32.


4:For adding to y right shifted by 5 bits we choose the key given by adding 3 to round number and then taking modulo 32.



This is done for every round.

                          

\includegraphics[scale=1]{3}

FIG 3: TEAM Encryption pseudocode




\newpage     

Taking one example:

Original Values: [ FFFFFFFF , FFFFFFFF ] 

K[0]=1  K[1]=2  K[2]=3  K[3]=4

Encrypted:       [ 9F7321B5 , 1DCC12D1 ]  


Decrypted:       [ FFFFFFFF , FFFFFFFF ]

\subsection{Limitations and Future Scope}
This proposed method has a few weaknesses. Most notably it has an increased complexity with respect to the original one as more calculations are being performed per encryption and decryption to figure out the original plaintext. With respect to the original cryptosystem , it has a lower plaintext space as three digits are being concatenated to the end of the plaintext.

We feel that TEA can still be improved in a much better way. Here we present some directions for future research:


-Improving the Fiestel block structure involved


-Introducing concept of Public and Private Key in the algorithm


-Improving upon the efficiency of the algorithm


-Introducing the key material slowly and randomly






\section{Conclusion}
The proposed modification 


     

\begin{thebibliography}{99}

\bibitem{c1} Feistel, H. (1973, May). “Cryptography and computer privacy.” Scientific American, 228. 
\bibitem{c2} Moon, D., Hwang, K., Lee, W., Lee, S., & Lim, J. (2002). Impossible differential cryptanalysis of reduced round XTEA and TEA. In Fast Software Encryption –Proceedings of the 9th International Workshop.  
\bibitem{c3}Wheeler, D.J., & Needham, R.J. (1994). TEA, a tiny encryption algorithm. In Fast Software Encryption – Proceedings of the 2nd International Workshop,1008. 
\bibitem{c4}Wheeler, D.J., & Needham, R.J. (1997). Tea extensions. Unpublished manuscript, Computer Laboratory, Cambridge University, England. 

\bibitem{c5}Stephanie Ang Yee Hunn, Norina binti Idris(2012)."The development of tiny encryption algorithm (TEA) crypto-core for mobile systems" 






\end{thebibliography}




\end{document}
